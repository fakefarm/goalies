(function(){this.app=angular.module("tasks"),this.app.controller("taskController",["$scope","taskModel","goalModel",function(n,t,e){var o,r,u,a,s;return e.index().then(function(t){var e;return n.goals=t.data,e={},_.each(n.goals,function(n){return e[n.id]=n.name}),n.align=function(n){return n.goal_id?e[n.goal_id]:"what goal?"}}),r=function(){return t.index().then(function(t){var e;return e=t.data,n.tasks=_.filter(e,function(n){return n.completed===!1&&moment(n.snooze)<moment()?n:void 0})})},o=function(){return t.index().then(function(t){var e;return e=t.data,n.completedTasks=_.filter(e,function(n){return n.completed===!0&&null===n.goal_id?n:void 0})})},s=function(){return t.index().then(function(t){var e;return e=t.data,n.snoozedTasks=_.filter(e,function(n){return n.completed===!1&&moment(n.snooze)>moment()?n:void 0})})},n["new"]=function(e){return e.snooze=moment(),n.tasks.push(e),n["new"].task={},t.postTask(e)},n.update=function(n){return t.update(n)},u=function(n,t){var e;return e="",_.each(n,function(o){return o.id===t.id?e=n.indexOf(t):void 0}),n.splice(e,1)},a=function(n,t){return n.push(t)},n.snooze=function(e){return e.snooze=moment(e.snooze).add(3,"days"),t.update(e),u(n.tasks,e),a(n.snoozedTasks,e)},n["return"]=function(e){return e.snooze=moment(),t.update(e),u(n.snoozedTasks,e),a(n.tasks,e)},n.undo=function(e){return e.completed=!1,t.update(e),u(n.completedTasks,e),a(n.tasks,e)},n.complete=function(e){return e.completed=!0,t.update(e),u(n.tasks,e),a(n.completedTasks,e)},n.destroy=function(n){return t.destroy(n).then(function(){return n["delete"]=!0})},r(),o(),s()}])}).call(this);