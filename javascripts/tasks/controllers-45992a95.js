(function(){this.app=angular.module("tasks"),this.app.controller("taskController",["$scope","taskModel","goalModel",function(n,t,e){var o,r,s,u,a,i;return e.index().then(function(t){var e;return n.goals=t.data,e={},_.each(n.goals,function(n){return e[n.id]=n.name}),n.align=function(n){return n.goal_id?e[n.goal_id]:"what goal?"}}),r=function(){return t.index().then(function(t){var e;return e=t.data,n.tasks=_.filter(e,function(n){return n.completed===!1&&moment(n.snooze)<moment()?n:void 0})})},o=function(){return t.index().then(function(t){var e;return e=t.data,n.completedTasks=_.filter(e,function(n){return n.completed===!0?n:void 0})})},s=function(){return t.index().then(function(t){var e;return e=t.data,n.snoozedTasks=_.filter(e,function(n){return n.completed===!1&&moment(n.snooze)>moment()?n:void 0})})},u=function(t){var e;return e="",_.each(n.tasks,function(o){return o.id===t.id?e=n.tasks.indexOf(t):void 0}),n.tasks.splice(e,1)},i=function(t){var e;return e="",_.each(n.snoozedTasks,function(o){return o.id===t.id?e=n.snoozedTasks.indexOf(t):void 0}),n.snoozedTasks.splice(e,1)},a=function(t){var e;return e="",_.each(n.completedTasks,function(o){return o.id===t.id?e=n.completedTasks.indexOf(t):void 0}),n.completedTasks.splice(e,1)},n["new"]=function(e){return e.snooze=moment(),n.tasks.push(e),n.task="",t.postTask(e)},n.update=function(n){return t.update(n)},n.snooze=function(e){return e.snooze=moment(e.snooze).add(3,"days"),t.update(e),n.snoozedTasks.push(e),u(e)},n["return"]=function(e){return e.snooze=moment(),t.update(e),n.tasks.push(e),i(e)},n.undo=function(e){return e.completed=!1,t.update(e),n.tasks.push(e),a(e)},n.complete=function(e){return e.completed=!0,t.update(e),n.completedTasks.push(e),u(e)},n.destroy=function(n){return t.destroy(n).then(function(){return n["delete"]=!0})},r(),o(),s()}])}).call(this);